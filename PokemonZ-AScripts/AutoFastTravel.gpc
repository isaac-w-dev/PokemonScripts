// GPC Online Library
// pokemon_z_a_fast_map_teleport_oled_menu
// Version: 1.0
// Author: Adrilr11
// Link: https://gpclib.cmindapi.com/gpc-library/11885

// ==================================================================
// GPC MEGASCRIPT FOR POKÃ‰MON LEGENDS: Z-A
// Version: 1.0 (Fast Teleport Edition)
// Author: Adrilr11 (based on seph9515's logic)
// ==================================================================
//
// DESCRIPTION:
// This script automates the map reset process for Shiny Hunting
// in PokÃ©mon Legends: Z-A. It uses a "fast teleport" method
// by moving the map cursor directly to a predefined zone.
//
// FEATURES:
// - OLED Menu: Select your target zone (1-20) directly on the Zen.
// - Fast Travel: Uses stick input for quicker navigation than lists.
// - Auto-Loop: Automatically repeats the reset process endlessly.
// - Nintendo Switch Native: Controls adapted for Switch Pro Controller.
//
// CONTROLS (HOLD ZL TO ACCESS MENU):
// [ZL] + [UP/DOWN]  : Cycle through Target Zones (1-20) on OLED screen.
// [ZL] + [R]        : START/STOP the automatic loop.
//
// HOW TO USE:
// 1. Ensure your character is in the open world (not in a menu).
// 2. Hold ZL and use UP/DOWN to select the zone you want to farm.
// 3. Hold ZL and press R to START. The LED will turn GREEN.
// 4. To stop, hold ZL and press R again. The LED will turn RED.
// ==================================================================

// === CONFIGURATION ===
int RAPID_A_DURATION = 1000; // How long to spam A (in ms)
int RAPID_A_SPEED = 50; // Delay between A presses (lower = faster)
int INITIAL_PAUSE = 4000; // Initial pause for the first click (in ms)
int PAUSE_BETWEEN_LOOPS = 0; // Pause before restarting (in ms). We will add INITIAL_PAUSE to this time to know the total time.

// === OLED CONSTANTS ===
const string TXT_TITLE1  = "POKEMON ZA";
const string TXT_TITLE2  = "FAST TRAVEL";
const string TXT_STOPPED = "STOPPED";
const string TXT_RUNNING = "RUNNING!";
const string TXT_ZONE    = "ZONE TARGET:";

// NUCLEAR OPTION: Manual string array for numbers 1-20
const string N01="1";  const string N02="2";  const string N03="3";  const string N04="4";  const string N05="5";
const string N06="6";  const string N07="7";  const string N08="8";  const string N09="9";  const string N10="10";
const string N11="11"; const string N12="12"; const string N13="13"; const string N14="14"; const string N15="15";
const string N16="16"; const string N17="17"; const string N18="18"; const string N19="19"; const string N20="20";

// === SCREENSAVER CONFIG ===
define OLED_TIMEOUT = 5000; // 5 seconds (in ms) before screen turns off

// === GLOBAL VARIABLES ===
int TARGET_ZONE = 1;
int SCRIPT_RUNNING = FALSE;
int intro_done = 0; // 0=Not Started, 1=Running, 2=Waiting Update, 3=Done
int teleport_stage = 0;
int oled_timer = OLED_TIMEOUT;
int screen_is_off = FALSE;

// Variables for the new fast teleport method
int stick_x_val = 0; // -100 = left, 100 = right, 0 = no horizontal input
int stick_y_val = 0; // -100 = up, 100 = down, combine with stickX for diagonal
int move_ms_val = 0; // How long to hold the stick (in ms)

// === INITIALIZATION ===
init {
    set_led(LED_1, 0); set_led(LED_2, 1); set_led(LED_3, 0); set_led(LED_4, 0);
}

// === MAIN LOOP ===
main {
    // --- INTRO SEQUENCE (STATE MACHINE) ---
    if(intro_done == 0) {
        combo_run(Intro_Screen);
        intro_done = 1;
    }
    if(intro_done == 1) {
        if(!combo_running(Intro_Screen)) {
            intro_done = 2;
        }
    }
    if(intro_done == 2) {
        combo_run(UPDATE_OLED);
        intro_done = 3;
    }
    if(intro_done >= 3) {
        // --- SCREENSAVER LOGIC ---
        // If timer is running, decrease it by elapsed time
        if(oled_timer > 0) {
            oled_timer = oled_timer - get_rtime();
            if(oled_timer <= 0) {
                // Time's up! Turn off screen.
                cls_oled(0);
                screen_is_off = TRUE;
                oled_timer = 0; // Stop counting down
            }
        }
        // --- NORMAL MAIN LOOP ---

        // --- MENU CONTROLS ---
        if(get_val(SWI_ZL)) {
        	if(event_press(SWI_UP) || event_press(SWI_DOWN) || event_press(SWI_R)) {
                // WAKE UP SCREEN if it was off
                if(screen_is_off) {
                    screen_is_off = FALSE;
                    combo_run(UPDATE_OLED);
                }
                // Reset timer on ANY interaction
                oled_timer = OLED_TIMEOUT; 
            }
            if(event_press(SWI_UP)) {
                TARGET_ZONE = TARGET_ZONE + 1;
                if(TARGET_ZONE > 20) TARGET_ZONE = 1;
                combo_run(UPDATE_OLED);
            }
            if(event_press(SWI_DOWN)) {
                TARGET_ZONE = TARGET_ZONE - 1;
                if(TARGET_ZONE < 1) TARGET_ZONE = 20;
                combo_run(UPDATE_OLED);
            }
            if(event_press(SWI_R)) {
                SCRIPT_RUNNING = !SCRIPT_RUNNING;
                if(SCRIPT_RUNNING) {
                     set_led(LED_1, 0); set_led(LED_2, 0); set_led(LED_3, 1); set_led(LED_4, 0);
                     teleport_stage = 0; 
                } else {
                     set_led(LED_1, 0); set_led(LED_2, 1); set_led(LED_3, 0); set_led(LED_4, 0);
                     combo_stop(Fast_Teleport);
                     combo_stop(Rapid_A_Spam);
                }
                combo_run(UPDATE_OLED);
            }
            set_val(SWI_UP, 0); set_val(SWI_DOWN, 0); set_val(SWI_R, 0);
        }

        // --- AUTO-EXECUTION STATE MACHINE ---
        if(SCRIPT_RUNNING) {
            if(teleport_stage == 0) {
                 // 1. CONFIGURE COORDINATES BASED ON TARGET ZONE
                 // YOU MUST EDIT THESE VALUES FOR YOUR GAME!
                 // stick_x_val: -100 (Left) to 100 (Right)
                 // stick_y_val: -100 (Up) to 100 (Down)
                 // move_ms_val: Time in ms to hold stick (distance)
                 if(TARGET_ZONE == 1)  { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 2)  { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 3)  { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 4)  { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 5)  { stick_x_val = 0; stick_y_val = -100; move_ms_val = 110; } // Increased move time slightly for testing
                 if(TARGET_ZONE == 6)  { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 7)  { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 8)  { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 9)  { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 10) { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 11) { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 12) { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 13) { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 14) { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 15) { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 16) { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 17) { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 18) { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 19) { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }
                 if(TARGET_ZONE == 20) { stick_x_val = 0; stick_y_val = 0; move_ms_val = 0; }

                 combo_run(Fast_Teleport);
                 teleport_stage = 1;
            }
            if(teleport_stage == 1 && !combo_running(Fast_Teleport)) {
                teleport_stage = 0; 
            }
        }
    }
}

// === INTRO SCREEN COMBO ===
combo Intro_Screen {
    cls_oled(0);
    wait(100);
    print(10, 20, OLED_FONT_MEDIUM, OLED_WHITE, TXT_TITLE1[0]);
    print(10, 40, OLED_FONT_MEDIUM, OLED_WHITE, TXT_TITLE2[0]);
    wait(2000); 
}

// === OLED UPDATE COMBO ===
combo UPDATE_OLED {
    cls_oled(0);
    wait(100); 
    if(SCRIPT_RUNNING) {
        print(0, 0, OLED_FONT_MEDIUM, OLED_WHITE, TXT_RUNNING[0]); 
    } else {
        print(0, 0, OLED_FONT_MEDIUM, OLED_WHITE, TXT_STOPPED[0]);
    }
    print(0, 30, OLED_FONT_MEDIUM, OLED_WHITE, TXT_ZONE[0]);

    if(TARGET_ZONE == 1) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N01[0]);
    if(TARGET_ZONE == 2) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N02[0]);
    if(TARGET_ZONE == 3) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N03[0]);
    if(TARGET_ZONE == 4) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N04[0]);
    if(TARGET_ZONE == 5) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N05[0]);
    if(TARGET_ZONE == 6) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N06[0]);
    if(TARGET_ZONE == 7) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N07[0]);
    if(TARGET_ZONE == 8) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N08[0]);
    if(TARGET_ZONE == 9) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N09[0]);
    if(TARGET_ZONE == 10) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N10[0]);
    if(TARGET_ZONE == 11) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N11[0]);
    if(TARGET_ZONE == 12) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N12[0]);
    if(TARGET_ZONE == 13) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N13[0]);
    if(TARGET_ZONE == 14) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N14[0]);
    if(TARGET_ZONE == 15) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N15[0]);
    if(TARGET_ZONE == 16) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N16[0]);
    if(TARGET_ZONE == 17) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N17[0]);
    if(TARGET_ZONE == 18) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N18[0]);
    if(TARGET_ZONE == 19) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N19[0]);
    if(TARGET_ZONE == 20) print(0, 45, OLED_FONT_LARGE, OLED_WHITE, N20[0]);

    wait(200);
}

// === FAST TELEPORT COMBO (UPDATED TIMINGS) ===
combo Fast_Teleport {
    // 1. Open Map (+)
    wait(INITIAL_PAUSE);
    set_val(SWI_PLUS, 100);
    wait(100);
    set_val(SWI_PLUS, 0);
    wait(100);

    // 2. Move Stick to Target
    set_val(SWI_LX, stick_x_val);
    set_val(SWI_LY, stick_y_val);
    wait(move_ms_val);
    set_val(SWI_LX, 0);
    set_val(SWI_LY, 0);
    wait(100);

    // 3. Spam A to confirm travel
    combo_run(Rapid_A_Spam);
    wait(RAPID_A_DURATION);
    combo_stop(Rapid_A_Spam); 

    // 4. Wait for loading screen
    wait(PAUSE_BETWEEN_LOOPS);
}

combo Rapid_A_Spam {
    set_val(SWI_A, 100);
    wait(RAPID_A_SPEED);
    set_val(SWI_A, 0);
    wait(RAPID_A_SPEED);
    combo_run(Rapid_A_Spam); // keeps it looping until stopped
}
 ú¼½Œ´Œ´„¶„´ƒ¶‡¾